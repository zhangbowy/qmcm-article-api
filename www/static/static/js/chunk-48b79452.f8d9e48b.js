(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48b79452"],{"09fe":function(t,e,i){},"13d5":function(t,e,i){"use strict";var o=i("23e7"),s=i("d58f").left,a=i("a640"),n=i("ae40"),c=a("reduce"),r=n("reduce",{1:0});o({target:"Array",proto:!0,forced:!c||!r},{reduce:function(t){return s(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"3d19":function(t,e,i){},"46f7":function(t,e,i){"use strict";var o=i("3d19"),s=i.n(o);s.a},"504b":function(t,e,i){},"73f5":function(t,e,i){"use strict";var o=i("bb62"),s=i.n(o);s.a},b084:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("van-nav-bar",{staticStyle:{color:"#333"},attrs:{title:t.title,"left-text":t.leftText,"right-text":t.rightText,"left-arrow":""},on:{"click-left":t.onClickLeft}})],1)},s=[],a={props:{title:{type:String,default:""},leftText:{type:String,default:""},rightText:{type:String,default:""}},methods:{onClickLeft:function(){this.$router.go(-1)}}},n=a,c=i("2877"),r=Object(c["a"])(n,o,s,!1,null,null,null);e["a"]=r.exports},bb62:function(t,e,i){},c40e:function(t,e,i){"use strict";i.d(e,"b",(function(){return s}));var o=i("b775"),s={getGoodsList:function(t){return Object(o["a"])({url:"/goods/getGoods",method:"post",data:t})},getGoodsDetail:function(t){return Object(o["a"])({url:"/goods/detail",method:"post",data:t})}}},d58f:function(t,e,i){var o=i("1c0b"),s=i("7b0b"),a=i("44ad"),n=i("50c4"),c=function(t){return function(e,i,c,r){o(i);var l=s(e),u=a(l),h=n(l.length),d=t?h-1:0,m=t?-1:1;if(c<2)while(1){if(d in u){r=u[d],d+=m;break}if(d+=m,t?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;t?d>=0:h>d;d+=m)d in u&&(r=i(r,u[d],d,l));return r}};t.exports={left:c(!1),right:c(!0)}},e7e5:function(t,e,i){"use strict";i("68ef"),i("a71a"),i("9d70"),i("3743"),i("4d75"),i("e3b3"),i("b258")},eb34:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"goods-detail"},[i("div",{staticClass:"navbar"},[i("top-bar")],1),i("div",{staticClass:"good-content"},[i("div",{staticClass:"good-images"},[i("van-swipe",{on:{change:t.onChange},scopedSlots:t._u([{key:"indicator",fn:function(){return[i("div",{staticClass:"custom-indicator"},[t._v(" "+t._s(t.current+1)+"/"+t._s(t.goodDetail.images.length)+" ")])]},proxy:!0}])},t._l(t.goodDetail.images,(function(e,o){return i("van-swipe-item",{key:e},[i("img",{attrs:{src:e,alt:""},on:{click:function(e){return t.preview(o)}}})])})),1)],1),i("div",{staticClass:"good-info"},[i("div",{staticClass:"good-name"},[i("p",[t._v(t._s(t.goodDetail.name))]),i("span",[t._v(t._s(t.goodDetail.real_sale)+"人付款")])]),i("div",{staticClass:"share-btn",on:{click:function(e){t.share=!0}}},[i("svg-icon",{attrs:{"icon-class":"share"}}),t._v(" "),i("span",[t._v("分享")])],1),i("div",{staticClass:"good-price"},[t._v(" ￥ "),i("span",{staticClass:"current-price"},[t._v(t._s(t.goodDetail.current_price))]),i("span",{staticClass:"old-price"},[t._v("￥"+t._s(t.goodDetail.old_price))])])]),i("div",{staticClass:"good-cell"},[i("div",{staticClass:"cell-item",on:{click:t.changeSkuShow}},[i("span",{staticClass:"cell-title"},[t._v("已选")]),i("span",{staticClass:"cell-content"},[t._v(t._s(t.checkedSku))]),i("span",{staticClass:"right-arrow"},[i("svg-icon",{attrs:{"icon-class":"right-arrow"}})],1)])]),i("div",{staticClass:"sku-box"},[i("van-action-sheet",{attrs:{title:"选择规格"},model:{value:t.showSku,callback:function(e){t.showSku=e},expression:"showSku"}},[i("div",{staticClass:"content"},[t.skuItem?i("div",{staticClass:"sku-info"},[i("img",{attrs:{src:t.skuItem.images?t.skuItem.images:t.goodDetail.thumb_image_path,width:"96",height:"96",alt:""}}),i("div",{staticClass:"right-info"},[i("p",{staticClass:"price"},[t._v("￥"+t._s(t.skuItem.current_price))]),i("p",[t._v("剩余"+t._s(t.skuItem.num))]),i("p",[t._v("已选："),t._l(t.skuItem.skus,(function(e){return i("span",{key:e.k+e.v},[t._v(t._s(e.k)+":"+t._s(e.v)+" ")])})),t._v(t._s(t.skuItem.checked))],2)])]):t._e(),i("div",{staticClass:"good-number"},[i("van-cell",{attrs:{title:"选择数量"}},[[i("van-stepper",{attrs:{min:t.goodDetail.min_buy,max:t.goodDetail.max_buy,"input-width":"30px","button-size":"22px"},model:{value:t.goodNumber,callback:function(e){t.goodNumber=e},expression:"goodNumber"}})]],2)],1),i("div",{staticClass:"sku-list"},t._l(t.skudata,(function(e,o){return i("div",{key:e.id+"_id",staticClass:"sku-item"},[i("span",{staticClass:"sku-item-name"},[t._v(t._s(e.value)+":")]),t.showSku?i("div",{staticClass:"sku-item-attr"},t._l(e.leaf,(function(e){return i("span",{key:e.id,staticClass:"attr-name",class:{active:t.activeSku[o].option&&t.activeSku[o].option.id===e.id},on:{click:function(i){return t.selectSku(o,e)}}},[t._v(t._s(e.value))])})),0):t._e()])})),0),i("div",{staticClass:"good-adction"},[i("van-goods-action",[i("van-goods-action-button",{attrs:{type:"warning",text:"加入购物车"},on:{click:t.skuAddCart}}),i("van-goods-action-button",{attrs:{type:"danger",text:"立即购买"},on:{click:t.skuBuy}})],1)],1)])])],1),i("div",{staticClass:"detail"},[i("div",{staticClass:"title"},[t._v("商品详情")]),i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.goodDetail.detail)}})]),i("div",{staticClass:"good-adction"},[i("van-goods-action",[i("van-goods-action-icon",{attrs:{icon:"wap-home-o",text:"首页"},on:{click:function(e){return t.pathTo("/")}}}),i("van-goods-action-icon",{attrs:{icon:"cart-o",text:"购物车"},on:{click:function(e){return t.pathTo("/cart")}}}),i("van-goods-action-button",{attrs:{type:"warning",text:"加入购物车"},on:{click:t.onClickButton}}),i("van-goods-action-button",{attrs:{type:"danger",text:"立即购买"},on:{click:t.onClickButton}})],1)],1),i("van-share-sheet",{attrs:{title:"立即分享给好友",options:t.options},on:{select:t.onSelect},model:{value:t.share,callback:function(e){t.share=e},expression:"share"}})],1)])},s=[],a=(i("99af"),i("c975"),i("d81d"),i("13d5"),i("b0c0"),i("e7e5"),i("d399")),n=(i("68ef"),i("a71a"),i("9d70"),i("3743"),i("09fe"),i("4d75"),i("e3b3"),i("8270"),i("786d"),i("504b"),i("c31d")),c=i("2b0e"),r=i("d282"),l=i("482d"),u=i("1325"),h=i("6605"),d=i("3875"),m=i("2638"),v=i.n(m),g=i("a142"),f=i("ea8e"),p=i("ad06"),k=Object(r["a"])("image"),b=k[0],S=k[1],w=b({props:{src:String,fit:String,alt:String,round:Boolean,width:[Number,String],height:[Number,String],radius:[Number,String],lazyLoad:Boolean,showError:{type:Boolean,default:!0},showLoading:{type:Boolean,default:!0},errorIcon:{type:String,default:"warning-o"},loadingIcon:{type:String,default:"photo-o"}},data:function(){return{loading:!0,error:!1}},watch:{src:function(){this.loading=!0,this.error=!1}},computed:{style:function(){var t={};return Object(g["b"])(this.width)&&(t.width=Object(f["a"])(this.width)),Object(g["b"])(this.height)&&(t.height=Object(f["a"])(this.height)),Object(g["b"])(this.radius)&&(t.overflow="hidden",t.borderRadius=Object(f["a"])(this.radius)),t}},created:function(){var t=this.$Lazyload;t&&(t.$on("loaded",this.onLazyLoaded),t.$on("error",this.onLazyLoadError))},beforeDestroy:function(){var t=this.$Lazyload;t&&(t.$off("loaded",this.onLazyLoaded),t.$off("error",this.onLazyLoadError))},methods:{onLoad:function(t){this.loading=!1,this.$emit("load",t)},onLazyLoaded:function(t){var e=t.el;e===this.$refs.image&&this.loading&&this.onLoad()},onLazyLoadError:function(t){var e=t.el;e!==this.$refs.image||this.error||this.onError()},onError:function(t){this.error=!0,this.loading=!1,this.$emit("error",t)},onClick:function(t){this.$emit("click",t)},genPlaceholder:function(){var t=this.$createElement;return this.loading&&this.showLoading?t("div",{class:S("loading")},[this.slots("loading")||t(p["a"],{attrs:{name:this.loadingIcon},class:S("loading-icon")})]):this.error&&this.showError?t("div",{class:S("error")},[this.slots("error")||t(p["a"],{attrs:{name:this.errorIcon},class:S("error-icon")})]):void 0},genImage:function(){var t=this.$createElement,e={class:S("img"),attrs:{alt:this.alt},style:{objectFit:this.fit}};if(!this.error)return this.lazyLoad?t("img",v()([{ref:"image",directives:[{name:"lazy",value:this.src}]},e])):t("img",v()([{attrs:{src:this.src},on:{load:this.onLoad,error:this.onError}},e]))}},render:function(){var t=arguments[0];return t("div",{class:S({round:this.round}),style:this.style,on:{click:this.onClick}},[this.genImage(),this.genPlaceholder()])}}),C=i("5596"),_=i("543e"),y=i("2bb1"),I=Object(r["a"])("image-preview"),x=I[0],$=I[1];function T(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}var O,D=x({mixins:[Object(h["a"])({skipToggleEvent:!0}),d["a"]],props:{className:null,asyncClose:Boolean,showIndicators:Boolean,images:{type:Array,default:function(){return[]}},loop:{type:Boolean,default:!0},swipeDuration:{type:[Number,String],default:500},overlay:{type:Boolean,default:!0},showIndex:{type:Boolean,default:!0},startPosition:{type:[Number,String],default:0},minZoom:{type:[Number,String],default:1/3},maxZoom:{type:[Number,String],default:3},overlayClass:{type:String,default:$("overlay")},closeable:Boolean,closeIcon:{type:String,default:"clear"},closeIconPosition:{type:String,default:"top-right"}},data:function(){return{scale:1,moveX:0,moveY:0,active:0,moving:!1,zooming:!1,doubleClickTimer:null}},computed:{imageStyle:function(){var t=this.scale,e={transitionDuration:this.zooming||this.moving?"0s":".3s"};return 1!==t&&(e.transform="scale3d("+t+", "+t+", 1) translate("+this.moveX/t+"px, "+this.moveY/t+"px)"),e}},watch:{startPosition:"setActive",value:function(t){var e=this;t?(this.setActive(+this.startPosition),this.$nextTick((function(){e.$refs.swipe.swipeTo(+e.startPosition,{immediate:!0})}))):this.$emit("close",{index:this.active,url:this.images[this.active]})},shouldRender:{handler:function(t){var e=this;t&&this.$nextTick((function(){var t=e.$refs.swipe.$el;Object(u["b"])(t,"touchstart",e.onWrapperTouchStart),Object(u["b"])(t,"touchmove",u["c"]),Object(u["b"])(t,"touchend",e.onWrapperTouchEnd),Object(u["b"])(t,"touchcancel",e.onWrapperTouchEnd)}))},immediate:!0}},methods:{emitClose:function(){this.asyncClose||this.$emit("input",!1)},onWrapperTouchStart:function(){this.touchStartTime=new Date},onWrapperTouchEnd:function(t){var e=this;Object(u["c"])(t);var i=new Date-this.touchStartTime,o=this.$refs.swipe||{},s=o.offsetX,a=void 0===s?0:s,n=o.offsetY,c=void 0===n?0:n;i<300&&a<10&&c<10&&(this.doubleClickTimer?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.toggleScale()):this.doubleClickTimer=setTimeout((function(){e.emitClose(),e.doubleClickTimer=null}),300))},startMove:function(t){var e=t.currentTarget,i=e.getBoundingClientRect(),o=window.innerWidth,s=window.innerHeight;this.touchStart(t),this.moving=!0,this.startMoveX=this.moveX,this.startMoveY=this.moveY,this.maxMoveX=Math.max(0,(i.width-o)/2),this.maxMoveY=Math.max(0,(i.height-s)/2)},startZoom:function(t){this.moving=!1,this.zooming=!0,this.startScale=this.scale,this.startDistance=T(t.touches)},onImageTouchStart:function(t){var e=t.touches,i=this.$refs.swipe||{},o=i.offsetX,s=void 0===o?0:o;1===e.length&&1!==this.scale?this.startMove(t):2!==e.length||s||this.startZoom(t)},onImageTouchMove:function(t){var e=t.touches;if((this.moving||this.zooming)&&Object(u["c"])(t,!0),this.moving){this.touchMove(t);var i=this.deltaX+this.startMoveX,o=this.deltaY+this.startMoveY;this.moveX=Object(l["a"])(i,-this.maxMoveX,this.maxMoveX),this.moveY=Object(l["a"])(o,-this.maxMoveY,this.maxMoveY)}if(this.zooming&&2===e.length){var s=T(e),a=this.startScale*s/this.startDistance;this.setScale(a)}},onImageTouchEnd:function(t){if(this.moving||this.zooming){var e=!0;this.moving&&this.startMoveX===this.moveX&&this.startMoveY===this.moveY&&(e=!1),t.touches.length||(this.moving=!1,this.zooming=!1,this.startMoveX=0,this.startMoveY=0,this.startScale=1,this.scale<1&&this.resetScale()),e&&Object(u["c"])(t,!0)}},setActive:function(t){this.resetScale(),t!==this.active&&(this.active=t,this.$emit("change",t))},setScale:function(t){var e=Object(l["a"])(t,+this.minZoom,+this.maxZoom);this.scale=e,this.$emit("scale",{index:this.active,scale:e})},resetScale:function(){this.setScale(1),this.moveX=0,this.moveY=0},toggleScale:function(){var t=this.scale>1?1:2;this.setScale(t),this.moveX=0,this.moveY=0},genIndex:function(){var t=this.$createElement;if(this.showIndex)return t("div",{class:$("index")},[this.slots("index")||this.active+1+" / "+this.images.length])},genCover:function(){var t=this.$createElement,e=this.slots("cover");if(e)return t("div",{class:$("cover")},[e])},genImages:function(){var t=this,e=this.$createElement,i={loading:function(){return e(_["a"],{attrs:{type:"spinner"}})}};return e(C["a"],{ref:"swipe",attrs:{lazyRender:!0,loop:this.loop,indicatorColor:"white",duration:this.swipeDuration,initialSwipe:this.startPosition,showIndicators:this.showIndicators},class:$("swipe"),on:{change:this.setActive}},[this.images.map((function(o,s){return e(y["a"],[e(w,{attrs:{src:o,fit:"contain"},class:$("image"),scopedSlots:i,style:s===t.active?t.imageStyle:null,nativeOn:{touchstart:t.onImageTouchStart,touchmove:t.onImageTouchMove,touchend:t.onImageTouchEnd,touchcancel:t.onImageTouchEnd}})])}))])},genClose:function(){var t=this.$createElement;if(this.closeable)return t(p["a"],{attrs:{role:"button",name:this.closeIcon},class:$("close-icon",this.closeIconPosition),on:{click:this.emitClose}})},onClosed:function(){this.$emit("closed")}},render:function(){var t=arguments[0];if(this.shouldRender)return t("transition",{attrs:{name:"van-fade"},on:{afterLeave:this.onClosed}},[t("div",{directives:[{name:"show",value:this.value}],class:[$(),this.className]},[this.genClose(),this.genImages(),this.genIndex(),this.genCover()])])}}),L={loop:!0,images:[],value:!0,minZoom:1/3,maxZoom:3,className:"",onClose:null,onChange:null,showIndex:!0,closeable:!1,closeIcon:"clear",asyncClose:!1,startPosition:0,swipeDuration:500,showIndicators:!1,closeOnPopstate:!1,closeIconPosition:"top-right"},j=function(){O=new(c["a"].extend(D))({el:document.createElement("div")}),document.body.appendChild(O.$el),O.$on("change",(function(t){O.onChange&&O.onChange(t)})),O.$on("scale",(function(t){O.onScale&&O.onScale(t)}))},M=function(t,e){if(void 0===e&&(e=0),!g["f"]){O||j();var i=Array.isArray(t)?{images:t,startPosition:e}:t;return Object(n["a"])(O,L,i),O.$once("input",(function(t){O.value=t})),O.$once("closed",(function(){O.images=[]})),i.onClose&&(O.$off("close"),O.$once("close",i.onClose)),O}};M.install=function(){c["a"].use(D)};var E=M,z=i("b084"),X=i("c40e"),Y={components:{TopBar:z["a"]},data:function(){return{current:0,checkedSku:"请选择规格",showSku:!1,share:!1,goodDetail:{images:[]},skuList:[],skudata:[],activeSku:[],skuItem:{},options:[{name:"微信",icon:"wechat"}],goodNumber:0,checkedSkuIds:"",id:this.$route.query.good_id}},watch:{skudata:{deep:!0,immediate:!0,handler:function(t){this.activeSku=t.map((function(t){return{spec:{value:t.value,id:t.id},option:{}}}))}},activeSku:{deep:!0,immediate:!0,handler:function(t){var e=this;this.checkedSkuIds=this.activeSku.reduce((function(t,i,o){return"".concat(t).concat(i.spec.id,"-").concat(i.option.id).concat(o===e.activeSku.length-1?"":"_")}),"")}},checkedSkuIds:{deep:!0,immediate:!0,handler:function(t){var e=this,i=[];this.skuList.map((function(t){t.sku_id===e.checkedSkuIds&&(e.skuItem=t,e.checkedSku=t.skus.reduce((function(t,e,i){return"".concat(t,'"').concat(e.v,'" ')}),"")),i.push(t.sku_id),i.indexOf(e.checkedSkuIds)<0&&(e.checkedSku="请选择规格",e.skuItem={current_price:e.goodDetail.current_price,num:e.goodDetail.sum_stock,images:e.goodDetail.thumb_image_path})}))}}},created:function(){this.goodsId=this.$route.query.good_id,this.fetchData(this.goodsId)},methods:{fetchData:function(t){var e=this;X["b"].getGoodsDetail({id:t}).then((function(t){e.goodDetail=t.data,e.goodDetail.images=JSON.parse(t.data.images),e.skuList=JSON.parse(t.data.sku_list),e.skudata=JSON.parse(t.data.sku_show),e.skuItem.current_price=t.data.current_price,e.skuItem.num=t.data.sum_stock,e.skuItem.images=t.data.thumb_image_path}))},onChange:function(t){this.current=t},preview:function(t){E({images:this.goodDetail.images,startPosition:t})},changeSkuShow:function(){this.showSku=!this.showSku},selectSku:function(t,e){this.activeSku[t].option&&this.activeSku[t].option.id===e.id?this.activeSku[t].option={}:this.activeSku[t].option=e},pathTo:function(t){this.$router.push({path:t})},onClickButton:function(){this.skuItem.sku_id||this.changeSkuShow()},shareIsShow:function(t){console.log(t),this.share=t},skuAddCart:function(){console.log(1),Object(a["a"])("您点击了添加购物车")},skuBuy:function(){console.log(2),Object(a["a"])("您点击了购买")},onSelect:function(t){switch(t.name){case"微信":this.bindShareTimeLine();break;case"朋友圈":this.bindShareAppMessage();break;case"QQ":this.bindShareQQ();break;case"QQ空间":this.bindShareQzone();break}}}},B=Y,N=(i("46f7"),i("73f5"),i("2877")),P=Object(N["a"])(B,o,s,!1,null,"251ea27e",null);e["default"]=P.exports}}]);